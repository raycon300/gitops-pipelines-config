{{ if .Values.pipelines }}
{{ range $pipeline := .Values.pipelines }}
{{ $pipelineName := $pipeline.pipeName }}
{{ $pvcSize := $pipeline.pvcSize | default "2Gi"  }}
{{ $namespace := $pipeline.projectOcName }}

---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: pipeline-build-workspace-{{ $pipelineName }}
  namespace: {{ $namespace }}
spec:
  resources:
    requests:
      storage: {{$pvcSize}}
  volumeMode: Filesystem
  accessModes:
    - ReadWriteOnce
{{ end }}
{{ end }}
